\section{参数估计}
\subsection{点估计}

\begin{definition}
    点估计问题的一般提法如下：设总体$X$的分布函数$F(x;\theta)$的形式为已知，$\theta$是待估
    参数.$X_1,X_2,\cdots,X_n$是$X$的一个样本，$x_1,x_2,\cdots,x_n$是相应的一个样本值.
    点估计问题就是要构造一个适当的统计量$\hat{\theta}(X_1,X_2,\cdots,X_n)$，用它的观察值
    $\hat{\theta}(x_1,x_2,\cdots,x_n)$作为未知参数$\theta$的近似值。称$\hat{\theta}(X_1,X_2,\cdots,X_n)$
    为$\theta$的{\heiti 估计量}，称$\hat{\theta}(x_1,x_2,\cdots,x_n)$为$\theta$的{\heiti 估计值}。
    在不致混淆的情况下统称估计量和估计值为{\heiti 估计}.
\end{definition}

\begin{definition}[矩估计法]
    设$X$为连续型随机变量，其概率密度为$f(x;\theta_1,\theta_2,\cdots,\theta_k)$，或$X$为离散型随机变量，
    其分布律为$P\{X=x\}=p(x;\theta_1,\theta_2,\cdots,\theta_k)$，其中$\theta_1,\theta_2,\cdots,\theta_k$
    为待估参数，$X_1,X_2,\cdots,X_n$是来自$X$的样本.假设总体$X$的前$k$阶矩
    $$\mu_l=E(X^l)=\int_{-\infty}^\infty x^lf(x;\theta_1,\theta_2,\cdots,\theta_k)\,dx\quad X\mbox{为连续型}$$
    或
    $$\mu_l=E(X^l)=\sum_{x\in R_X}x^lp(x;\theta_1,\theta_2,\cdots,\theta_k)\quad X\mbox{为离散型}$$
    （$l=1,2,\cdots,k$,其中$R_X$是$X$可能取值的范围）存在。一般来说，它们是$\theta_1,\theta_2,\cdots,\theta_k$
    的函数.基于样本矩
    $$A_l=\frac{1}{n}\sum_{i=1}^nX_i^l$$
    依概率收敛于相应的总体矩$\mu_l(l=1,2,\cdots,k)$，样本矩的连续函数依概率收敛于相应的总体矩的连续函数，我们就用样本矩
    作为相应的总体矩的估计量，而以样本矩的连续函数作为相应的总体矩的连续函数的估计量。这种估计方法称为{\heiti 矩估计法}。

    矩估计法的具体做法如下：设
    $$\left\{\begin{array}{l}
        \mu_1=\mu_1(\theta_1,\theta_2,\cdots,\theta_k),\\
        \mu_2=\mu_2(\theta_1,\theta_2,\cdots,\theta_k),\\
        \vdots\\
        \mu_k=\mu_k(\theta_1,\theta_2,\cdots,\theta_k),\\
    \end{array}\right.$$
    这是一个包含$k$个未知参数$\theta_1,\theta_2,\cdots,\theta_k$的联立方程组。一般来说，可以从中解出$\theta_1,\theta_2,\cdots,\theta_k$，
    得到
    $$\left\{\begin{array}{l}
        \theta_1=\theta_1(\mu_1,\mu_2,\cdots,\mu_k),\\
        \theta_2=\theta_2(\mu_1,\mu_2,\cdots,\mu_k),\\
        \vdots\\
        \theta_k=\theta_k(\mu_1,\mu_2,\cdots,\mu_k),\\
    \end{array}\right.$$
    以$A_i$分别代替上式中的$\mu_i,i=1,2,\cdots,k$，就以
    $$\hat{\theta}_i=\theta_i(A_1,A_2,\cdots,A_k),i=1,2,\cdots,k$$
    分别作为$\theta_i,i=1,2,\cdots,k$的估计量，这种估计量称为{\heiti 矩估计量}，矩估计量的观察值称为{\heiti 矩估计值}.
\end{definition}

\begin{definition}[最大似然估计法]
    若总体$X$属离散型，其分布律$P\{X=x\}=p(x;\theta),\theta\in \varTheta$的形式为已知，$\theta$为待估参数，$\varTheta$
    是$\theta$可能取值的范围.设$X_1,X_2,\cdots,X_n$是来自$X$的样本，则$X_1,X_2,\cdots,X_n$的联合分布律为
    $$\prod_{i=1}^np(x_i;\theta)$$
    又设$x_1,x_2,\cdots,x_n$是相应于样本$X_1,X_2,\cdots,X_n$的一个样本值.易知样本$X_1,X_2,\cdots,X_n$取到
    观察值$x_1,x_2,\cdots,x_n$的概率，亦即事件$\{X_1=x_1,X_2=x_2,\cdots,X_n=x_n\}$发生的概率为
    $$L(\theta)=L(x_1,x_2,\cdots,x_n;\theta)=\prod_{i=1}^np(x_i;\theta),\theta\in\varTheta$$
    这一概率随$\theta$的取值而变化，它是$\theta$的函数，$L(\theta)$称为样本的{\heiti 似然函数}。
    （注意，这里$x_1,x_2,\cdots,x_n$是已知的样本值，它们都是常数）.

    由费希尔引进的最大似然估计法，就是固定样本观察值$x_1,x_2,\cdots,x_n$，在$\theta$取值的可能范围$\varTheta$内挑选使似然函数
    $L(x_1,x_2,\cdots,x_n;\theta)$达到最大的参数值$\hat{\theta}$，作为参数$\theta$的估计值.即取$\hat{\theta}$使
    $$L(x_1,x_2,\cdots,x_n;\hat{\theta})=\max\limits_{\theta\in\varTheta}L(x_1,x_2,\cdots,x_n;\theta)$$
    这样得到的$\hat{\theta}$与样本值$x_1,x_2,\cdots,x_n$有关，常记为$\hat{\theta}(x_1,x_2,\cdots,x_n)$，称为参数$\theta$
    的{\heiti 最大似然估计值}，而相应的统计量$\hat{\theta}(X_1,X_2,\cdots,X_n)$称为参数$\theta$的{\heiti 最大似然估计量}.

    若总体$X$属连续型，其概率密度$f(x;\theta),\theta\in\varTheta$的形式已知，$\theta$为待估参数，$\varTheta$是$\theta$
    可能取值的范围.设$X_1,X_2,\cdots,X_n$是来自$X$的样本，则$X_1,X_2,\cdots,X_n$的联合密度为
    $$\prod_{i=1}^nf(x_i,\theta)$$
    设$x_1,x_2,\cdots,x_n$是相应于样本$X_1,X_2,\cdots,X_n$的一个样本值，则随机点$(X_1,X_2,\cdots,X_n)$落在点
    $(x_1,x_2,\cdots,x_n)$的邻域（边长分别为    $\,dx_1,\,dx_2,\cdots,\,dx_n$的$n$维立方体）内的概率近似地为
    \begin{equation}\tag{1}\label{7.1}
    \prod_{i=1}^nf(x_i;\theta)\,dx_i
    \end{equation}
    其值随$\theta$的取值而变化。与离散型的情况一样，取$\theta$的估计值$\hat{\theta}$使概率\eqref{7.1}取到最大值，但因子
    $\displaystyle{\prod_{i=1}^n\,dx_i}$不随$\theta$而变，故只考虑函数
    $$L(\theta)=L(x_1,x_2,\cdots,x_n;\theta)=\prod_{i=1}^nf(x_i;\theta)$$
    的最大值.这里$L(\theta)$称为样本的{\heiti 似然函数}.若
    $$L(x_1,x_2,\cdots,x_n;\hat{\theta})=\max\limits_{\theta\in \varTheta}L(x_1,x_2,\cdots,x_n;\theta)$$
    则称$\hat{\theta}(x_1,x_2,\cdots,x_n)$为$\theta$的{\heiti 最大似然估计值}，称$\hat{\theta}(X_1,X_2,\cdots,X_n)$为
    $\theta$的{\heiti 最大似然估计量}。
    
    这样，确定最大似然估计量的问题就归结为微分学中的求最大值的问题了。

    在很多情况下，$p(x;\theta)$和$f(x;\theta)$关于$\theta$可微，这时$\hat{\theta}$常可从方程
    $$\frac{d}{d\theta}L(\theta)=0$$
    解得.又因$L(\theta)$和$\ln L(\theta)$在同一$\theta$处取到极值，因此，$\theta$的最大似然估计$\theta$也可以从方程
    \begin{equation}\tag{2}\label{7.2}
    \frac{d}{d\theta} \ln L(\theta)=0
    \end{equation}
    求得，而从后一方程求解往往比较方便。\eqref{7.2}称为{\heiti 对数似然方程}。

    最大似然估计法也适用于分布中含多个未知参数$\theta_1,\theta_2,\cdots,\theta_k$的情况。这时，似然函数$L$是这些未知参数的函数.
    分别令
    $$\frac{\partial}{\partial \theta_i}L=0,i=1,2,\cdots,k$$
    或令
    \begin{equation}\tag{3}\label{7.3}
    \frac{\partial}{\partial \theta_i}\ln L=0,i=1,2,\cdots,k
    \end{equation}
    解上述由$k$个方程组成的方程组，即可得到各未知参数$\theta_i(i=1,2,\cdots,k)$的最大似然估计值$\hat{\theta}_i$.
    \eqref{7.3}称为{\heiti 对数似然方程组}。
\end{definition}

\begin{theorem}
    最大似然估计具有下述性质：设$\theta$的函数$u=u(\theta),\theta\in \varTheta$具有单值反函数$\theta=\theta(u),u\in \mathfrak{U}$。又假设
    $\hat{\theta}$是$X$的概率分布中参数$\theta$的最大似然估计，则$\hat{u}=u(\hat{\theta})$是$u(\theta)$的最大似然估计。这一性质称为最大似然估计的{\heiti 不变性}.

    事实上，因为$\hat{\theta}$是$\theta$的最大似然估计，于是有
    $$L(x_1,x_2,\cdots,x_n;\theta)=\max\limits_{\theta\in \varTheta}L(x_1,x_2,\cdots,x_n,\theta)$$
    其中$x_1,x_2,\cdots,x_n$是$X$的一个样本值，考虑到$\hat{u}=u(\hat{\theta})$，且有$\hat{\theta}=\theta(\hat{u})$，上式可写成
    $$L(x_1,x_2,\cdots,x_n;\theta(\hat{u}))=\max\limits_{u\in \mathfrak{U}}L(x_1,x_2,\cdots,x_n;\theta(u))$$
    这就证明了$\hat{u}=u(\hat{\theta})$是$u(\theta)$的最大似然估计。

    当总体分布含有多个未知参数时，也具有上述性质。例如$\sigma^2$的最大似然估计为
    $$\hat{\sigma^2}=\frac{1}{n}\sum_{i=1}^n{(X_i-\overline{X})}^2$$
    函数$u=u(\sigma^2)=\sqrt{\sigma^2}$有单值反函数$\sigma^2=u^2(u\geq 0)$，根据上述性质，得到标准差$\sigma$的最大似然估计为
    $$\hat{\sigma}=\sqrt{\hat{\sigma^2}}=\sqrt{\frac{1}{n}\sum_{i=1}^n{(X_i-\overline{X})}^2}$$
\end{theorem}

\subsection{估计量的评选标准}
\begin{definition}[无偏性]
    若估计量$\hat{\theta}=\hat{\theta}(X_1,X_2,\cdots,X_n)$的数学期望$E(\hat{\theta})$存在，且对于任意$\theta\in \varTheta$有
    $$E(\hat{\theta})=\theta$$
    则称$\hat{\theta}$是$\theta$的{\heiti 无偏估计量}。
\end{definition}

\begin{definition}[有效性]
    设$\hat{\theta}_1=\hat{\theta}_1(X_1,X_2,\cdots,X_n)$与$\hat{\theta}_2=\hat{\theta}_2(X_1,X_2,\cdots,X_n)$都是
    $\theta$的无偏估计量，若对于任意$\theta\in \varTheta$，有
    $$D(\hat{\theta}_1)\leq D(\hat{\theta}_2)$$
    且至少对于某一个$\theta\in \varTheta$上式中的不等号成立，则称$\hat{\theta}_1$较$\hat{\theta}_2${\heiti 有效}。
\end{definition}

\begin{definition}[相合性]
    设$\hat{\theta}(X_1,X_2,\cdots,X_n)$为参数$\theta$的估计量，
    若对于任意$\theta\in \varTheta$，当$n \to \infty$时$\hat{\theta}(X_1,\\X_2,\cdots,X_n)$
    依概率收敛于$\theta$，则称$\hat{\theta}$为$\theta$的{\heiti 相合估计量}。

    即，若对任意$\theta\in \varTheta$都满足：对任意$\varepsilon>0$，有
    $$\lim_{n\to\infty} P\{|\hat{\theta}-\theta|<\varepsilon\}=1$$
    则称$\hat{\theta}$是$\theta$的{\heiti 相合估计量}。
\end{definition}

\subsection{区间估计}
\begin{definition}[置信区间]
    设总体$X$的分布函数$F(x;\theta)$含有一个未知参数$\theta,\theta\in \varTheta$（$\varTheta$是$\theta$可能取值的范围），对于
    给定值$\alpha(0<\alpha<1)$，若由来自$X$的样本$X_1,X_2,\cdots,X_n$确定的两个统计量$\underline{\theta}=\underline{\theta}(X_1,X_2,\cdots,X_n)$
    和$\overline{\theta}=\overline{\theta}(X_1,X_2,\cdots,X_n)(\theta<\overline{\theta})$，对于任意$\theta\in\varTheta$满足
    $$P\{\underline{\theta}(X_1,X_2,\cdots,X_n)<\theta<\overline{\theta}(X_1,X_2,\cdots,X_n)\}\geq 1-\alpha$$
    则称随机区间$(\underline{\theta},\overline{\theta})$是$\theta$的置信水平为$1-\alpha$的{\heiti 置信区间}，$\underline{\theta}$和$\overline{\theta}$分别称为
    置信水平为$1-\alpha$的双侧置信区间的{\heiti 置信下限}和{\heiti 置信上限}，$1-\alpha$称为{\heiti 置信水平}。

    当$X$时离散型随机变量时，对于给定的$\alpha$，常常找不到区间$(\underline{\theta},\overline{\theta})$使得$P\{\underline{\theta}<\theta<\overline{\theta}\}$恰为
    $1-\alpha$。此时去找区间$(\underline{\theta},\overline{\theta})$使得$P\{\underline{\theta}<\theta<\overline{\theta}\}$至少为$1-\alpha$，且尽可能地接近$1-\alpha$.
\end{definition}

\begin{theorem}
    寻求未知参数$\theta$的置信区间的具体做法：
    \begin{enumerate}[1°]
        \item 寻求一个样本$X_1,X_2,\cdots,X_n$和$\theta$的函数$W=W(X_1,X_2,\cdots,X_n;\theta)$，使得$W$的分布不依赖于
        $\theta$以及其他未知参数，称具有这种性质的函数$W$为{\heiti 枢轴量}.
        \item 对于给定的置信水平$1-\alpha$，定出两个常数$a,b$，使得
        $$P\{a<W(X_1,X_2,\cdots,X_n;\theta)<b\}=1-\alpha$$
        若能从$a<W(X_1,X_2,\cdots,X_n;\theta)<b$得到与之等价的$\theta$的不等式$\underline{\theta}<\theta<\overline{\theta}$，其中
        $\underline{\theta}=\underline{\theta}(X_1,X_2,\cdots,X_n),\overline{\theta}=\overline{\theta}(X_1,X_2,\cdots,X_n)$都是统计量。
        那么$(\underline{\theta},\overline{\theta})$就是$\theta$的一个置信水平为$1-\alpha$的置信区间。
    \end{enumerate}
    
    枢轴量$W(X_1,X_2,\cdots,X_n;\theta)$的构造，通常可以从$\theta$的点估计着手考虑。常用的正态总体的参数的置信区间可以用上述步骤推得。
\end{theorem}

\subsection{正态总体均值与方差的区间估计}
\begin{theorem}
    设已给定置信水平为$1-\alpha$，并设$X_1,X_2,\cdots,X_n$为总体$N(\mu,\sigma^2)$的样本。$\overline{X},S^2$分别是样本均值和样本方差。
    \begin{enumerate}[1.]
        \item 均值为$\mu$的置信区间
        \begin{enumerate}[(1)]
            \item $\sigma^2$为已知，可得$\mu$的一个置信水平为$1-\alpha$的置信区间为
            $$(\overline{X}\pm \frac{\sigma}{\sqrt{n}}z_{\alpha/2})$$
            \item $\sigma^2$为未知，可得$\mu$的一个置信水平为$1-\alpha$的置信区间为
            $$(\overline{X}\pm \frac{S}{\sqrt{n}}t_{\alpha/2}(n-1))$$
        \end{enumerate}
        \item 方差$\sigma^2$的置信区间
            
        方差$\sigma^2$的一个置信水平为$1-\alpha$的置信区间为
        $$\left(\frac{(n-1)S^2}{\chi ^2_{\alpha/2}(n-1)},\frac{(n-1)S^2}{\chi^2_{1-\alpha/2}(n-1)}\right)$$
        标准差$\sigma$的一个置信水平为$1-\alpha$的置信区间为
        $$\left(\frac{\sqrt{n-1}S}{\sqrt{\chi ^2_{\alpha/2}(n-1)}},\frac{\sqrt{n-1}S}{\sqrt{\chi^2_{1-\alpha/2}(n-1)}}\right)$$
    \end{enumerate}        
\end{theorem}

\begin{theorem}
    设已给定置信水平为$1-\alpha$，并设$X_1,X_,2,\cdots,X_{n_1}$是来自第一个总体的样本；$Y_1,Y_2,\cdots,Y_{n_2}$是来自第二个
    总体的样本，这两个样本相互独立。且设$\overline{X},\overline{Y}$分别为第一、第二个总体的样本均值，$S_1^2,S_2^2$分别是第一、第二个
    总体的样本方差。
    \begin{enumerate}[1.]
        \item 两个总体均值差$\mu_1-\mu_2$的置信区间
        \begin{enumerate}[(1)]
            \item $\sigma_1^2,\sigma_2^2$均为已知，$\mu_1-\mu_2$的一个置信水平为$1-\alpha$的置信区间$$\left(\overline{X}-\overline{Y}\pm z_{\alpha/2}\sqrt{\frac{\sigma_1^2}{n_1}+\frac{\sigma^2_2}{n_2}}\right)$$
            \item $\sigma_1^2=\sigma_2^2=\sigma^2$，但$\sigma^2$未知，此时$\mu_1-\mu_2$的一个置信水平为$1-\alpha$的置信区间为
            $$\left(\overline{X}-\overline{Y}\pm t_{\alpha/2}(n_1+n_2-2)S_w\sqrt{\frac{1}{n_1}+\frac{1}{n_2}}\right)$$
            此处$\displaystyle{S_w^2=\frac{(n_1-1)S_1^2+(n_2-1)S_2^2}{n_1+n_2-2},S_w=\sqrt{S_w^2}}$
        \end{enumerate}
        \item 两个总体方差比$\sigma_1^2/\sigma_2^2$的置信区间
        
        对于总体均值$\mu_1,\mu_2$均为未知时，$\sigma_1^2/\sigma_2^2$的一个置信水平为$1-\alpha$的置信区间为
        $$\left(\frac{S_1^2}{S_2^2}\frac{1}{F_{\alpha/2}(n_1-1,n_2-1)},\frac{S_1^2}{S_2^2}\frac{1}{F_{1-\alpha/2}(n_1-1,n_2-1)}\right)$$
    \end{enumerate} 
\end{theorem}

\subsection{（0-1）分布参数的区间估计}
    \begin{theorem}
        已知$(0-1)$分布的均值和方差分别为$$\mu=p,\sigma^2=p(1-p)$$
        设$X_1,X_2,\cdots,X_n$是一个样本，因样本容量$n$比较大，由中心极限定理，知
        $$\frac{\sum\limits_{i=1}^n X_i-np}{\sqrt{np(1-p)}}=\frac{n\overline{X}-np}{\sqrt{np(1-p)}}$$
        近似地服从$N(0,1)$分布，于是有
        $$P\left\{-z_{\alpha/2}<\frac{n\overline{X}-np}{\sqrt{np(1-p)}}<z_{\alpha/2}\right\}\approx 1-\alpha$$
        而不等式
        \begin{equation}\tag{4}\label{7.6}
            -z_{\alpha/2}<\frac{n\overline{X}-np}{\sqrt{np(1-p)}}<z_{\alpha/2}
        \end{equation}
        等价于
        $$(n+z^2_{\alpha/2})p^2-(2n\overline{X}+z^2_{\alpha/2})p+n\overline{X}^2<0$$
        记$$p_1=\frac{1}{2a}(-b-\sqrt{b^2-4ac})$$
        $$p_2=\frac{1}{2a}(-b+\sqrt{b^2-4ac})$$
        此处$a=n+z^2_{\alpha/2},b=-(2n\overline{X}+z^2_{\alpha/2}),c=n\overline{X}^2$。于是由\eqref{7.6}式得$p$的一个近似的置信水平为$1-\alpha$的置信区间为
        $$(p_1,p_2)$$
    \end{theorem}
 
\subsection{单侧置信区间}
    \begin{definition}
        对于给定值$\alpha(0<\alpha<1)$，若由样本$X_1,X_2,\cdots,X_n$确定的统计量$\underline{\theta}=\underline{\theta}(X_1,X_2,\cdots,X_n)$，对于任意$\theta\in \varTheta$满足
        $$P\{\theta>\underline{\theta}\}\geq 1-\alpha$$
        称随机区间$(\underline{\theta},\infty)$是$\theta$的置信水平为$1-\alpha$的{\heiti 单侧置信区间}，$\underline{\theta}$称为$\theta$的置信水平为$1-\alpha$的{\heiti 单侧置信下限}。

        又若统计量$\overline{\theta}=\overline{\theta}(X_1,X_2,\cdots,X_n)$，对于任意$\theta\in \varTheta$满足
        $$P\{\theta<\overline{\theta}\}\geq 1-\alpha$$
        称随机区间$(-\infty,\overline{\theta})$是$\theta$的置信水平为$1-\alpha$的{\heiti 单侧置信区间}，$\overline{\theta}$称为$\theta$的置信水平为$1-\alpha$的{\heiti 单侧置信上限}。

        例如对于正态总体$X$，若均值$\mu$，方差$\sigma^2$均为未知，设$X_1,X_2,\cdots,X_n$是一个样本，由
        $$\frac{\overline{X}-\mu}{S/\sqrt{n}}\sim t(n-1)$$
        有$$P\left\{\frac{\overline{X}-\mu}{S/\sqrt{n}}<t_\alpha(n-1)\right\}=1-\alpha$$
        即$$P\left\{\mu>\overline{X}-\frac{S}{\sqrt{n}}t_\alpha(n-1)\right\}=1-\alpha$$
        于是得到$\mu$的置信水平为$1-\alpha$的单侧置信区间
        $$\left(\overline{X}-\frac{S}{\sqrt{n}}t_\alpha(n-1),\infty\right)$$
        $\mu$的置信水平为$1-\alpha$的单侧置信下限为
        $$\underline{\mu}=\overline{X}-\frac{S}{\sqrt{n}}t_\alpha(n-1)$$
        又由$$\frac{(n-1)S^2}{\sigma^2}\sim \chi^2(n-1)$$
        有
        $$P\left\{\frac{(n-1)S^2}{\sigma^2}>\chi_{1-\alpha}^2(n-1)\right\}=1-\alpha$$
        即
        $$P\left\{\sigma^2<\frac{(n-1)S^2}{\chi_{1-\alpha}^2(n-1)}\right\}=1-\alpha$$
        于是得$\sigma^2$的置信水平为$1-\alpha$的单侧置信区间
        $$\left(0,\frac{(n-1)S^2}{\chi_{1-\alpha}^2(n-1)}\right)$$
        $\sigma^2$的置信水平为$1-\alpha$的单侧置信上限为
        $$\overline{\sigma^2}=\frac{(n-1)S^2}{\chi_{1-\alpha}^2(n-1)}$$
    \end{definition}

    